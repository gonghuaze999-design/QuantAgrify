# QuantAgrify v3.3.0 Pro 版本更新报告

**作者:** Manus AI
**日期:** 2026年2月12日

## 1. 版本概述

QuantAgrify v3.3.0 Pro 版本在 v3.2.0 Pro 强大的“全栈融合”基础上，进一步聚焦于提升平台的全球化适应性和用户体验，核心亮点是引入了**“全球货币上下文”**功能，实现了 USD ($) 和 CNY (¥) 之间的动态切换，并确保了这一切换在整个模拟生命周期中的一致性。

## 2. 核心功能升级：全球货币上下文 (Global Currency Context)

v3.3.0 Pro 的最主要功能进步是全面实现了货币单位的动态切换和同步，这对于服务全球用户，特别是涉及跨市场交易的场景至关重要。

### 关键特性：
*   **全局状态持久化**：货币选择（例如在 `PortfolioAssets` 中进行的设置）现在能够持久化到 `GLOBAL_EXCHANGE` 引擎配置中，确保用户选择的货币偏好在不同会话中得以保留。
*   **跨模块同步**：货币切换逻辑已无缝集成到多个核心模块中，包括：
    *   **投资组合资产 (Portfolio Assets)**：作为货币配置的入口点。
    *   **分析驾驶舱 (Analysis Cockpit)**：实时显示权益和盈亏（PnL）时，能够根据所选货币进行动态调整。
    *   **风险管理 (Risk Management)**：VaR (Value at Risk) 和最大回撤 (Drawdown) 等风险计算指标会根据当前货币上下文进行精确计算。
    *   **深度分析 (In-Depth Analytics)**：性能归因指标同样会根据货币设置进行展示。
*   **模拟模式下的自由切换**：在模拟/训练模式下，用户可以自由切换货币单位，这极大地便利了不同货币环境下的策略测试和学习。在真实交易模式下，货币单位则会锁定为经纪商提供的源数据货币，确保数据的一致性和准确性。

## 3. 架构演进

*   **核心引擎增强**：`SimulationEngine.ts` (VirtualExchange) 现在负责维护 `baseCurrency` 状态，成为货币上下文的核心管理单元。
*   **前端响应机制**：前端 React 组件通过订阅引擎状态更新（轮询频率为 200ms-1000ms），能够即时反映货币变化，无需刷新页面即可实现无缝切换，提供了流畅的用户体验。

## 4. 后端中间件与质量保障

*   **后端中间件 (`backend/main.py`)**：保持稳定状态，继续提供 GEE 代理、JQData 桥接和 CORS 处理等关键服务。
*   **质量保障 (`tests/`)**：现有的测试套件（`audit_simulation.py` 和 `comprehensive_scenario_test.py`）继续为平台的算法完整性和鲁棒性提供保障。

## 5. 部署说明

*   **版本:** v3.3.0-almost (在 `metadata.json` 中显示为 `3.3.0-almost`，`SNAPSHOT_README.md` 中也为 `v3.3.0-almost`)
*   **目标:** Web (响应式桌面/平板)。
*   **状态:** 所有模块（数据源、算法、驾驶舱、风险、资产）均已集成并保持一致性。

## 6. 总结

v3.3.0 Pro 版本通过引入“全球货币上下文”功能，显著提升了 QuantAgrify 平台的国际化能力和用户体验。这一改进使得平台能够更好地服务于全球范围内的量化交易决策者，为他们提供更加灵活和精准的分析工具。同时，平台在后端集成和质量保障方面的稳定性也得到了持续维护和强化。
